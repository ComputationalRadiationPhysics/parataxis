#pragma once

namespace xrt {
namespace detector {

    namespace particleHandlers {

        /** Simply counts all incoming particles per cell */
        struct CountParticles;
        /** Adds particles per cell with wave properties (phase and amplitude) */
        struct AddWaveParticles;

    }  // namespace particleHandlers

    /** Placeholder when no detector should be used */
    struct NoDetector;

    /**
     * Handles outgoing photons (light-like particles)
     */
    struct PhotonDetector
    {
        using IncomingParticleHandler=
            /**
             * Policy that defines how the detector handles incoming particles
             * Possible values \see particleHandlers
             */
            particleHandlers::PARAM_PARTICLEHANDLER
            ;

        /**
         * Distance of the detector from the right side of the volume
         * Unit: meter
         */
        static constexpr float_64 distance = 5;
        /**
         * Width and height of each detector cell
         * Unit: meter
         */
        static constexpr float_64 cellWidth = 350e-6;
        static constexpr float_64 cellHeight = 350e-6;

        /* Following values are used for constraint checking but do not influence the simulation */
        /** Minimum number of interference patterns (sequences of minima+maxima) that should be observable
         *  (Regards only half of the detector as other half is mirrored) */
        static constexpr uint32_t minNumMaxima = 10;
        /** Number of pixels required per interference pattern */
        static constexpr uint32_t resolutionFactor = 40;
        /** Structure size (in m) range that should be resolved (e.g. slit width, double slit distance, ...) */
        static constexpr float_64 minStructureSize = 8*4e-9;
        static constexpr float_64 maxStructureSize = 8*4e-9;
        /** Set to true to abort the simulation when the constraints are violated
         *  False still shows warnings*/
        static constexpr bool abortOnConstraintError = true;
    };

}  // namespace detector
}  // namespace xrt
